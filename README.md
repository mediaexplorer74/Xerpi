## Xerpi 1.1-pre-pre-pre-alpha - master branch

![](/Images/logo.png)

Это мой форк проекта Xerpi. Приложение Xerpi взаимодействует с API сайта **Derpibooru** (`https://derpibooru.org/`). 

Derpibooru — это популярный хостинг изображений, специализирующийся на пони-тематике (My Little Pony), где пользователи могут загружать, просматривать и комментировать изображения. 

Судя по коду, приложение использует API этого сайта для получения изображений, тегов, комментариев и другой информации. Сервис `DerpiNetworkService` (на который указывает найденный код) отвечает за сетевое взаимодействие с этим API.

Оригинал, похоже, не был дописан (особенно это касается платформо-зависимых вещей типа рендерера элементов списка).

## Скриншоты
![](/Images/sshot01.png)
![](/Images/sshot02.png)
![](/Images/sshot03.png)

## Мои "два цента"
- Попытался через ИИ как-то починюкать сию штуку. Криво-косо список картинок стал отображаться. Я выкинул платформенно-зависимый рендерер для повышения стабильности работы приложения (правда, теперь засбоила так называемая галлерея изображений на детальной странице).
- Чуток разобрался с "детальной страницей". Иногда стали отображаться одновременно и теги, и увеличенная (детальная) картинка. 
- Пофиксил страницу "Настройки". Теперь можно включать компактный режим, выбирать тему, отображение "кармы" и т.п. 

## Тех. детали
- Типы / таргеты: UWP + Android (Xamarin Forms engine used)
- .NET Standard 2.0
- Win. SDK used: 19041 (миним. версия SDK - 16299)

## План улучшения приложения
- Ошибка привязки: свойство 'CurrentSearchQuery' не найдено в 'ImageGridViewModel' (должно существовать для привязки TitleSearchBar)
- Логика навигации/ выбора переработана для повышения надежности
- Логика удаления страницы и выбора состояния может мешать навигации
- Улучшена логика отображения подробной информации на странице в ImageGalleryViewModel
- Исправлены проблемы с привязкой к строке поиска и настройкой выбора в ImageGridPage
- Исправлены проблемы с выходом индекса за пределы диапазона и навигацией в ImageGalleryViewModel (CurrentImageChanged, NavigateToSelectedImage)
- Улучшена обработка прокрутки UWP и обновлений коллекции в ImageGalleryViewModel
- Улучшена обработка ошибок навигации и прокрутки
- Ошибки прокрутки / индексации UWP сохраняются после недавних изменений
- Пользователь хочет устранить зависимость от UWP CarouselView и проблемную прокрутку, зависящую от платформы
- Планируется упростить логику навигации: использовать ручную навигацию "следующий" / "предыдущий" и соответствующим образом обновить пользовательский интерфейс
- Готовится к переходу на Xamarin.Forms 4.8, поэтому новое решение должно быть совместимым
- Удаление средств визуализации элементов без границ и замена стандартным вводом + эффектом
- Предупреждения о ссылках (CS8618, CS8604, CS8625, CS8602), которые могут быть аннулированы в нескольких файлах; будут устранены, начиная с инициализации события
- На странице сведений иногда отображается неправильное изображение или элемент управления пользовательским интерфейсом после навигации
- Исправлена ошибка навигации после возврата со страницы сведений путем сброса параметра _isDisposed и улучшения очистки в OnAppearingOverride / OnDisappearingOverride
- Исследование: Сосредоточено на изображении страницы сведений / проблеме отображения пользовательского интерфейса
- Активно проверяем Imagegallerypage XAML, code-behind и ImageGalleryViewModel на предмет проблем с привязкой / состоянием
- Исследование завершено: готово к внедрению /тестированию исправление неправильного отображения изображений / пользовательского интерфейса
- Теги иногда не отображаются при повторном переходе на страницу подробных сведений
- Навигация между изображениями в режиме подробного просмотра работает не так, как ожидалось
- Основное внимание будет уделено отладке привязки/обновления тегов и логики навигации в режиме подробного просмотра
- Исследование: Активная отладка проблем с привязкой/обновлением тегов и навигацией по изображениям в подробном представлении (UWP)
- Проверка всех ссылок на пакеты NuGet на совместимость с Xamarin.Forms 4.8
- Rg.Plugins.Всплывающие ссылки на пакеты удалены в рамках рефакторинга
- Минимальное значение UWP. Обновление пакета Windows SDK снижено до 16299 в соответствии с последними изменениями пользователя
- Пользователь запросил включение режима постоянного кэширования на странице настроек; следует восстановить состояние при повторном входе на страницу и перезапуске приложения; по возможности применить к логике отображения изображений
- Переключатель кэширования теперь полностью интегрирован с логикой загрузки FFImageLoading/отображения изображений

## Список задач
- [x] Исправлены ошибки подписки на рассылку сообщений и компиляции
- [x] Добавьте свойство 'CurrentSearchQuery' в ImageGridViewModel или обновите привязку XAML, чтобы оно соответствовало фактическому свойству
- [x] Просмотрите и исправьте логику навигации от ImageGridPage к странице сведений (убедитесь, что выбор сброшен и навигация работает повторно)
- [x] Убедитесь, что на странице сведений отображаются выбранные изображения, теги и другая полезная информация
- [x] Исправлена привязка строки поиска и изменение выбора в ImageGridPage.
- [x] Переработать ImageGalleryViewModel для ручной навигации (удалить зависимость от CarouselView)
- [x] Обновить ImageGalleyPage.xaml, чтобы использовать элементы управления ручной навигацией (кнопки, области касания)
- [x] Обновите файл ImageGalleyPage.xaml.cs для использования жестов смахивания и ручной навигации.
- [x] Протестируйте и верифицируйте процесс выбора и навигации в UWP с помощью нового подхода
- [x] Доработайте UX и устраните все оставшиеся ошибки навигации или отображения
- [x] Замените BorderlessEntry в TitleSearchBar.xaml на Entry + effect.
- [x] Удалить BorderlessEntryRenderer.cs из проектов UWP и Android
- [x] Удалить ссылки на BorderlessEntryRenderer в файлах проекта
- [x] Внедрить EntryEffect и удаление границ для конкретной платформы (в процессе)
- [x] Удалить файл BorderlessEntry.cs из папки Controls
- [x] Исправить предупреждение об инициализации события CS8618 в TitleSearchBar.xaml.cs
- [x] Устранить оставшиеся предупреждения о недопустимых ссылках в viewmodels и сервисах
- [x] Устранить оставшиеся предупреждения о недопустимых ссылках в API-моделях
- [x] Исправить предупреждение о недопустимых ссылках в CommentsResponse.cs
- [x] Исправлены ошибки при отображении ссылок в ApiFilter.cs
- [x] Исправлены ошибки при отображении ссылок в ApiTag.cs
- [x] Изучите и исправьте неправильное отображение изображений / пользовательского интерфейса на странице сведений
- [x] Внедрить и протестировать исправление неправильного отображения изображения/ пользовательского интерфейса на странице сведений
- [x] Изучить и устранить проблему навигации после возврата со страницы сведений (сосредоточить внимание на логике выбора _isDisposed/_isprocessing)
- [x] Отладка и исправление проблем с привязкой/обновлением тегов в режиме подробного просмотра
- [x] Отладка и исправление навигации по изображениям в режиме подробного просмотра
- [x] Тестирование и проверка исправлений с тегами и навигацией в режиме подробного просмотра
- [x] Проверьте все ссылки на пакеты NuGet в каждом csproj на совместимость с Xamarin.Forms 4.8
- [ ] Добавьте проверки на null и исправьте предупреждения CS8602 в AppShell.xaml.cs.
- [ ] Добавить проверки на null и исправить предупреждения CS8602 в NavigablePage.cs
- [ ] Добавить проверки на null и исправить предупреждения CS8602 в NavigationService.cs
- [ ] Добавьте проверки на null и исправьте предупреждения CS8602 в ImageGalleryViewModel.cs
- [ ] Протестируйте и убедитесь, что улучшения безопасности null устраняют предупреждения
- [x] Добавьте переключатель постоянного кэширования на страницу настроек
  - [x] Реализуйте восстановление состояния при повторном входе на страницу и перезапуске приложения
  - [x] Интегрируйте параметр кэширования с логикой отображения изображений (если это возможно)

## Текущая цель
Внедрить и проверить интеграцию переключателей кэширования и безопасность null

## TODO
Попытаться серьезно порефакторить то перегруженное рюшками (сторонними модулями-пакетами) решение, упростить логику, добавить адаптив, откатиться с Xamarin Forms 5 на 4.8.

## Ссыли
- https://github.com/pingzing/Xerpi Оригинальный проект
- https://github.com/pingzing Автор Xerpi 


## ..
Как есть. Без поддержки. Исследовательская тема. "Сделай сам", что называется.

## .
[m][e] 2025